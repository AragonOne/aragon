#!/usr/bin/env node

require('dotenv').config()

const version = require('../package.json').version
const execute = require('child_process').execSync

// First two arguments are node and script name
const buildDir = process.argv[2] || 'public'

execute(`rimraf ${buildDir}`, { stdio: 'inherit' })
execute(`copy-aragon-ui-assets -n aragon-ui ./${buildDir}`, {
  stdio: 'inherit',
})

process.env.ARAGON_PACKAGE_VERSION = version
execute(
  `parcel build src/index.html --out-dir ./${buildDir} --public-url ./ --no-cache`,
  { stdio: 'inherit' }
)
